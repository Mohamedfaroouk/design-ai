const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-BVOUBjs7.js","assets/app-DIQ7ZFgU.css"])))=>i.map(i=>d[i]);
import{_ as P,I as S,J as z,u as H,a as N,b as T,r as x,s as j,x as F,k as d,g as o,i as w,n as c,j as n,t as _,w as h,H as J,o as l,l as $,y as C,c as Q}from"./main-BVOUBjs7.js";import{_ as q,a as K}from"./Modal-DxCEcttx.js";import{_ as W}from"./Select-DpMRXbk3.js";import{_ as X}from"./Spinner-DZSAR5Za.js";/* empty css            */const M={fetchList(i={}){return S.get("/client/ai-generations",i)},retry(i){return S.post(`/client/ai-generations/${i}/retry`)},async download(i){const t=(await P(async()=>{const{default:u}=await import("./main-BVOUBjs7.js").then(g=>g.Q);return{default:u}},__vite__mapDeps([0,1]))).default,r=localStorage.getItem("auth_token");return await t.get(`/api/client/ai-generations/${i}/download`,{responseType:"blob",headers:{Authorization:`Bearer ${r}`}})}},Y=z("clientAiGeneration",{state:()=>({generations:[],meta:null,loading:!1,error:null}),actions:{async fetchList(i={}){this.loading=!0,this.error=null;try{const t=await M.fetchList(i);return this.generations=t.data,this.meta=t.meta,t}catch(t){throw this.error=t.message,t}finally{this.loading=!1}},async retry(i){this.loading=!0,this.error=null;try{return await M.retry(i)}catch(t){throw this.error=t.message,t}finally{this.loading=!1}},async download(i){try{return await M.download(i)}catch(t){throw this.error=t.message,t}}}}),Z={class:"mb-6"},ee={key:0,class:"flex justify-center"},te=["src","alt"],ae={key:0,class:"flex justify-center"},se=["href"],oe=["src","alt"],ne={key:1,class:"flex justify-center"},re={key:2,class:"flex justify-center"},le={class:"flex flex-col items-center gap-1"},ie={class:"flex items-center gap-2"},de={class:"flex items-center justify-end gap-2"},ce=["disabled","onClick"],ue={key:0,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ge=["onClick"],_e={class:"mb-4"},me=["disabled"],pe={key:0},he={key:1},xe={__name:"AiGenerationIndex",setup(i){const{t}=H(),r=N(),p=T(),u=Y(),g=x({search:"",sortBy:"created_at",sortOrder:"desc",page:1,perPage:15,status:""}),B=j(()=>[{key:"original_image",label:t("ai_generation.columns.original_image"),sortable:!1,align:"center"},{key:"generated_image",label:t("ai_generation.columns.generated_image"),sortable:!1,align:"center"},{key:"status",label:t("ai_generation.columns.status"),sortable:!0},{key:"created_at",label:t("ai_generation.columns.created_at"),sortable:!0}]),V=j(()=>[{label:t("ai_generation.filters.all_statuses"),value:""},{label:t("ai_generation.statuses.pending"),value:"pending"},{label:t("ai_generation.statuses.processing"),value:"processing"},{label:t("ai_generation.statuses.completed"),value:"completed"},{label:t("ai_generation.statuses.failed"),value:"failed"}]),y=async()=>{try{await u.fetchList(g.value)}catch(e){p.error(e.message||t("common.error"))}},L=e=>{g.value.search=e,g.value.page=1,y()},A=({column:e,order:s})=>{g.value.sortBy=e,g.value.sortOrder=s,y()},I=e=>{g.value.page=e,y()},R=e=>{g.value={...g.value,...e,page:1},y()},U=e=>{const s=r.darkMode?{pending:"bg-gray-700 text-gray-300",processing:"bg-blue-900 text-blue-300",completed:"bg-green-900 text-green-300",failed:"bg-red-900 text-red-300"}:{pending:"bg-gray-200 text-gray-700",processing:"bg-blue-100 text-blue-700",completed:"bg-green-100 text-green-700",failed:"bg-red-100 text-red-700"};return s[e]||s.pending},b=x(null),O=async e=>{b.value=e.id;try{if(e.generated_image_url){const s=document.createElement("a");s.href=e.generated_image_url,s.download=`${e.product_name||"generated-image"}-${e.id}.png`,s.target="_blank",document.body.appendChild(s),s.click(),document.body.removeChild(s),p.success(t("ai_generation.messages.download_success"))}else{const s=await u.download(e.id),v=new Blob([s.data]),a=window.URL.createObjectURL(v),m=document.createElement("a");m.href=a,m.download=`${e.product_name||"generated-image"}-${e.id}.png`,document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(a),p.success(t("ai_generation.messages.download_success"))}}catch(s){p.error(s.message||t("ai_generation.errors.download_failed"))}finally{b.value=null}},f=x(!1),k=x(null),D=e=>{k.value=e,f.value=!0},E=async()=>{if(k.value)try{await u.retry(k.value.id),p.success(t("ai_generation.messages.retry_success")),f.value=!1,k.value=null,await y()}catch(e){p.error(e.message||t("ai_generation.errors.retry_failed"))}};return F(()=>{y()}),(e,s)=>{const v=J("tooltip");return l(),d("div",null,[o("div",Z,[o("h1",{class:c([n(r).darkMode?"text-gray-100":"text-gray-900","text-2xl font-bold transition-colors"])},_(e.$t("ai_generation.title")),3)]),w(q,{columns:B.value,data:n(u).generations,meta:n(u).meta,loading:n(u).loading,searchable:!1,filterable:!0,"search-placeholder":e.$t("ai_generation.search_placeholder"),onSearch:L,onSort:A,onPageChange:I,onFilter:R},{filters:h(({filters:a,updateFilter:m})=>[w(W,{"model-value":a.status,label:e.$t("ai_generation.filters.status"),options:V.value,"onUpdate:modelValue":G=>m("status",G)},null,8,["model-value","label","options","onUpdate:modelValue"])]),"cell-original_image":h(({row:a})=>[a.original_image_url?(l(),d("div",ee,[o("img",{src:a.original_image_url,alt:e.$t("ai_generation.original_image"),class:"h-12 w-12 rounded-md object-cover"},null,8,te)])):(l(),d("span",{key:1,class:c([n(r).darkMode?"text-gray-500":"text-gray-400","transition-colors"])},_(e.$t("ai_generation.no_image")),3))]),"cell-generated_image":h(({row:a})=>[a.generated_image_url?(l(),d("div",ae,[o("a",{href:a.generated_image_url,target:"_blank",class:"block hover:opacity-80 transition-opacity"},[o("img",{src:a.generated_image_url,alt:e.$t("ai_generation.generated_image"),class:"h-16 w-16 rounded-md object-cover shadow-sm"},null,8,oe)],8,se)])):a.status==="failed"?(l(),d("div",ne,[o("span",{class:c([n(r).darkMode?"text-red-400":"text-red-600","text-xs transition-colors"])},_(e.$t("ai_generation.statuses.failed")),3)])):(l(),d("div",re,[o("div",le,[o("span",{class:c([n(r).darkMode?"text-gray-500":"text-gray-400","text-xs transition-colors"])},_(e.$t("ai_generation.processing")),3)])]))]),"cell-status":h(({row:a})=>[o("div",ie,[o("span",{class:c([U(a.status),"inline-flex rounded-full px-2 py-1 text-xs font-semibold transition-colors"])},_(e.$t(`ai_generation.statuses.${a.status}`)),3),a.status==="failed"&&a.error_message?$((l(),d("span",{key:0,class:c([n(r).darkMode?"text-red-400":"text-red-600","cursor-help transition-colors"])},[...s[2]||(s[2]=[o("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],2)),[[v,a.error_message]]):C("",!0)])]),actions:h(({row:a})=>[o("div",de,[a.can_download?$((l(),d("button",{key:0,disabled:b.value===a.id,class:c([[n(r).darkMode?"text-green-400 hover:text-green-300":"text-green-600 hover:text-green-700",b.value===a.id?"opacity-50 cursor-not-allowed":"cursor-pointer"],"transition-colors"]),onClick:m=>O(a)},[b.value!==a.id?(l(),d("svg",ue,[...s[3]||(s[3]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])])):(l(),Q(X,{key:1,class:"h-5 w-5"}))],10,ce)),[[v,e.$t("ai_generation.actions.download")]]):C("",!0),a.can_retry?$((l(),d("button",{key:1,class:c([n(r).darkMode?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700","transition-colors cursor-pointer"]),onClick:m=>D(a)},[...s[4]||(s[4]=[o("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],10,ge)),[[v,e.$t("ai_generation.actions.retry")]]):C("",!0)])]),_:1},8,["columns","data","meta","loading","search-placeholder"]),w(K,{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=a=>f.value=a),title:e.$t("ai_generation.retry_modal.title"),size:"sm"},{footer:h(()=>[o("button",{onClick:s[0]||(s[0]=a=>f.value=!1),class:c(["px-4 py-2 border-2 rounded-lg font-medium transition-colors",n(r).darkMode?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"])},_(e.$t("common.cancel")),3),o("button",{onClick:E,disabled:n(u).loading,class:c(["px-4 py-2 rounded-lg font-medium text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",n(u).loading?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"])},[n(u).loading?(l(),d("span",pe,_(e.$t("common.loading"))+"...",1)):(l(),d("span",he,_(e.$t("ai_generation.actions.retry")),1))],10,me)]),default:h(()=>[o("div",{class:c([n(r).darkMode?"text-gray-300":"text-gray-700","transition-colors"])},[o("p",_e,_(e.$t("ai_generation.retry_modal.message")),1),o("p",{class:c([n(r).darkMode?"text-yellow-400":"text-yellow-600","text-sm font-semibold transition-colors"])},_(e.$t("ai_generation.retry_modal.warning")),3)],2)]),_:1},8,["modelValue","title"])])}}};export{xe as default};

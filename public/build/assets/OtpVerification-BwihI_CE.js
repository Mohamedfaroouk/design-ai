import{u as T,a as q,b as E,r as f,e as H,s as _,x as K,q as L,c as U,w as C,d as F,f as P,o as y,g as a,h as G,i as I,n as i,j as s,k as w,y as J,t as m,F as Q,z as W,l as X,A as Y,m as b,p as j}from"./main-BVOUBjs7.js";import{_ as Z}from"./AuthLayout-BeoVSq-9.js";import{_ as ee}from"./Button-Cdjrugd2.js";/* empty css            */import"./DarkModeToggle-CLUZm9Ld.js";const te={class:"flex justify-center"},ae=["dir"],re=["onUpdate:modelValue","onInput","onKeydown"],oe={class:"text-center space-y-2"},se=["disabled"],le={class:"text-center pt-2"},ve={__name:"OtpVerification",setup(ne){const B=F(),V=H(),{t:g}=T(),o=q(),x=E(),r=f(["","","","","",""]),l=f([]),v=f(!1),u=f(""),n=f(60);let h=null;const k=V.query.email||"user@example.com",D=_(()=>{const[e,t]=k.split("@");return`${e.charAt(0)+"*".repeat(e.length-2)+e.charAt(e.length-1)}@${t}`}),M=_(()=>r.value.every(e=>e!=="")),S=_(()=>r.value.join("")),z=(e,t)=>{const d=t.target.value;if(!/^\d*$/.test(d)){r.value[e]="";return}d&&e<r.value.length-1&&l.value[e+1]?.focus(),u.value=""},A=(e,t)=>{t.key==="Backspace"&&!r.value[e]&&e>0&&l.value[e-1]?.focus(),t.key==="ArrowLeft"&&e>0&&l.value[e-1]?.focus(),t.key==="ArrowRight"&&e<r.value.length-1&&l.value[e+1]?.focus()},N=e=>{e.preventDefault();const t=e.clipboardData.getData("text").trim();if(/^\d{6}$/.test(t)){const d=t.split("");r.value=d,l.value[5]?.focus(),u.value=""}},O=async()=>{if(M.value){v.value=!0,u.value="";try{const e=await j.verifyOtp({email:k,otp:S.value,type:"password_reset"});x.success(e.message||g("auth.otp.success")),B.push({name:"reset-password",query:{email:k}})}catch(e){u.value=e.message||g("auth.otp.error"),r.value=["","","","","",""],l.value[0]?.focus()}finally{v.value=!1}}},R=async()=>{if(!(n.value>0)){v.value=!0;try{const e=await j.resendOtp({email:k,type:"password_reset"});$(),x.success(e.message||g("auth.otp.codeSent"))}catch(e){x.error(e.message||g("auth.otp.resendError"))}finally{v.value=!1}}},$=()=>{n.value=60,h=setInterval(()=>{n.value--,n.value<=0&&clearInterval(h)},1e3)};return K(()=>{l.value[0]?.focus(),$()}),L(()=>{h&&clearInterval(h)}),(e,t)=>{const d=P("router-link");return y(),U(Z,{title:e.$t("auth.otp.title"),subtitle:e.$t("auth.otp.subtitle",{email:D.value})},{default:C(()=>[a("form",{onSubmit:G(O,["prevent"]),class:"space-y-6"},[a("div",te,[a("div",{class:i(["w-16 h-16 rounded-2xl flex items-center justify-center transition-colors",s(o).darkMode?"bg-primary-900/30":"bg-primary-100"])},[(y(),w("svg",{class:i(["w-8 h-8",s(o).darkMode?"text-primary-400":"text-primary-600"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[0]||(t[0]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"},null,-1)])],2))],2)]),a("div",null,[a("label",{class:i(["block text-sm font-semibold mb-3 transition-colors",s(o).darkMode?"text-gray-300":"text-gray-700"])},m(e.$t("auth.otp.enterCode")),3),a("div",{class:"flex gap-3 justify-center",dir:s(o).direction},[(y(!0),w(Q,null,W(r.value,(ie,p)=>X((y(),w("input",{key:p,ref_for:!0,ref:c=>l.value[p]=c,"onUpdate:modelValue":c=>r.value[p]=c,type:"text",inputmode:"numeric",maxlength:"1",onInput:c=>z(p,c),onKeydown:c=>A(p,c),onPaste:N,class:i(["w-12 h-14 text-center text-2xl font-bold rounded-xl border-2 transition-all duration-200 focus:outline-none",u.value?"border-red-500 bg-red-50/50 dark:bg-red-900/20":s(o).darkMode?"border-gray-600 bg-gray-800 text-gray-200 focus:border-primary-400 focus:ring-4 focus:ring-primary-900/50":"border-primary-200 bg-white text-gray-900 focus:border-primary focus:ring-4 focus:ring-primary-100"])},null,42,re)),[[Y,r.value[p]]])),128))],8,ae),u.value?(y(),w("p",{key:0,class:i(["mt-3 text-sm flex items-center justify-center gap-1",s(o).darkMode?"text-red-400":"text-red-600"])},[t[1]||(t[1]=a("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),b(" "+m(u.value),1)],2)):J("",!0)]),I(ee,{type:"submit",variant:"primary",loading:v.value,disabled:!M.value,class:"w-full"},{default:C(()=>[b(m(e.$t("auth.otp.verify")),1)]),_:1},8,["loading","disabled"]),a("div",oe,[a("p",{class:i(["text-sm transition-colors",s(o).darkMode?"text-gray-400":"text-gray-600"])},m(e.$t("auth.otp.didntReceive")),3),a("button",{type:"button",onClick:R,disabled:n.value>0,class:i(["text-sm font-medium transition-colors inline-flex items-center gap-2",n.value>0?"text-gray-400 cursor-not-allowed":s(o).darkMode?"text-primary-400 hover:text-primary-300":"text-primary-600 hover:text-primary-700"])},[t[2]||(t[2]=a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),b(" "+m(n.value>0?e.$t("auth.otp.resendIn",{seconds:n.value}):e.$t("auth.otp.resendCode")),1)],10,se)]),a("div",le,[I(d,{to:"/login",class:i(["inline-flex items-center gap-2 text-sm font-medium transition-colors",s(o).darkMode?"text-gray-400 hover:text-gray-300":"text-gray-600 hover:text-gray-700"])},{default:C(()=>[t[3]||(t[3]=a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),b(" "+m(e.$t("auth.otp.backToLogin")),1)]),_:1},8,["class"])])],32)]),_:1},8,["title","subtitle"])}}};export{ve as default};

import{a as j,b as D,u as E,s as F,e as O,r as h,x as T,l as z,k as H,g as l,n as m,j as r,t as v,h as I,i as d,c as L,y as P,w as $,d as G,H as J,o as V,m as k}from"./main-BlFFzjiD.js";import{u as K}from"./useForm-CrEMAn_Z.js";import{u as Q}from"./users-Iw77pHaO.js";import{u as W}from"./roles-DDJ5ckSk.js";import{_ as p}from"./TextInput-Bnmnj4Km.js";import{_ as X}from"./Select-Di2GlW_S.js";import{_ as S}from"./Button-Cpf1tbOB.js";/* empty css            */const Y={class:"flex items-center gap-4 mb-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_={class:"md:col-span-2"},ne={__name:"UsersForm",setup(x){const c=O(),f=G(),U=Q(),w=W(),i=j(),b=D(),{t:u}=E(),t=F(()=>!!c.params.id),g=h(!1),y=h([]),{form:o,loading:C,getError:n,post:M,put:q}=K({name:"",email:"",password:"",password_confirmation:"",role:""}),B=async()=>{g.value=!0;try{const e=await w.fetchList({perPage:100});y.value=w.roles.map(s=>({value:s.name,label:s.name.charAt(0).toUpperCase()+s.name.slice(1)}))}catch(e){b.error(e.message||u("common.error"))}finally{g.value=!1}},N=async()=>{try{t.value?await q(`/admin/users/${c.params.id}`,{successMessage:u("users.updateSuccess"),onSuccess:()=>f.push("/admin/users")}):await M("/admin/users",{successMessage:u("users.createSuccess"),onSuccess:()=>f.push("/admin/users")})}catch{}},R=async()=>{if(t.value)try{const e=await U.fetchOne(c.params.id);o.name=e.name,o.email=e.email,o.role=e.roles?.[0]?.name||""}catch(e){b.error(e.message||u("common.error")),f.push("/admin/users")}};return T(async()=>{await B(),await R()}),(e,s)=>{const A=J("motion-fade");return z((V(),H("div",null,[l("div",Y,[l("button",{onClick:s[0]||(s[0]=a=>e.$router.push("/admin/users")),class:m(["p-2 rounded-lg transition-colors",r(i).darkMode?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-700"])},[...s[7]||(s[7]=[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],2),l("h1",{class:m(["text-3xl font-bold transition-colors",r(i).darkMode?"text-gray-100":"text-gray-900"])},v(t.value?e.$t("users.editUser"):e.$t("users.addNew")),3)]),l("div",{class:m(["rounded-lg shadow p-6 transition-colors",r(i).darkMode?"bg-gray-800 border border-gray-700":"bg-white"])},[l("form",{onSubmit:I(N,["prevent"])},[l("div",Z,[d(p,{modelValue:r(o).name,"onUpdate:modelValue":s[1]||(s[1]=a=>r(o).name=a),label:e.$t("users.fields.name"),placeholder:e.$t("users.placeholders.name"),error:r(n)("name"),required:""},null,8,["modelValue","label","placeholder","error"]),d(p,{modelValue:r(o).email,"onUpdate:modelValue":s[2]||(s[2]=a=>r(o).email=a),type:"email",label:e.$t("users.fields.email"),placeholder:e.$t("users.placeholders.email"),error:r(n)("email"),required:""},null,8,["modelValue","label","placeholder","error"]),d(p,{modelValue:r(o).password,"onUpdate:modelValue":s[3]||(s[3]=a=>r(o).password=a),type:"password",label:e.$t("users.fields.password"),placeholder:e.$t("users.placeholders.password"),error:r(n)("password"),required:!t.value},null,8,["modelValue","label","placeholder","error","required"]),!t.value||r(o).password?(V(),L(p,{key:0,modelValue:r(o).password_confirmation,"onUpdate:modelValue":s[4]||(s[4]=a=>r(o).password_confirmation=a),type:"password",label:e.$t("users.fields.passwordConfirmation"),placeholder:e.$t("users.placeholders.passwordConfirmation"),error:r(n)("password_confirmation"),required:!t.value||!!r(o).password},null,8,["modelValue","label","placeholder","error","required"])):P("",!0),l("div",_,[d(X,{modelValue:r(o).role,"onUpdate:modelValue":s[5]||(s[5]=a=>r(o).role=a),label:e.$t("users.fields.role"),placeholder:e.$t("users.placeholders.role"),options:y.value,error:r(n)("role"),disabled:g.value,required:""},null,8,["modelValue","label","placeholder","options","error","disabled"])])]),l("div",{class:m(["flex items-center justify-end gap-4 mt-6 pt-6 border-t transition-colors",r(i).darkMode?"border-gray-700":"border-gray-200"])},[d(S,{type:"button",variant:"secondary",onClick:s[6]||(s[6]=a=>e.$router.push("/admin/users"))},{default:$(()=>[k(v(e.$t("common.cancel")),1)]),_:1}),d(S,{type:"submit",variant:"primary",loading:r(C)},{default:$(()=>[k(v(t.value?e.$t("common.update"):e.$t("common.create")),1)]),_:1},8,["loading"])],2)],32)],2)])),[[A]])}}};export{ne as default};
